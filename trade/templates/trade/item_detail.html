{% extends "trade/layout.html" %}

{% block content %}
{{ block.super }}

<h2>{{ item.title }}</h2>

<br>
{{ item.user }} <br>
{{ item.title }} <br>
{{ item.desc }} <br>
{{ item.amount }} <br>
<img src="{{ item.photo.url }}"/><br>
{{ item.category }} <br>
{{ item.sub_category }} <br>
{{ item.status }} <br>
{{ item.is_public }} <br>
{{ item.created_at }} <br>
{{ item.updated_at }} <br>
<br>

<a href="{% url "trade:item_update" item.pk %}">수정하기</a>
<a href="{% url "trade:item_delete" item.pk %}">삭제하기</a>



<!-- Comments Form -->
<h4>댓글을 달아보세요 !</h4>
<form action="." method="post">
    {{ form.as_p }}
    {% csrf_token %}
    <button type="submit" class="btn btn-primary" >댓글 달기</button>
</form>

<!-- Comment with nested comments -->
{% for comment in comments %}
    <div class="comment" style="background-color: powderblue">
        <p class="info">{{ comment.user }} | {{ comment.created_at }}
            <a href="{% url "trade:comment_update" pk=item.pk cid=comment.pk %}">수정</a></p>
            {{ comment.message|linebreaks }}

        {% for replay in comment.replies.all %}
            <p class="info">{{ replay.user }} | {{ replay.created_at }}</p>
            <li>{{ replay.message }}</li>
        {% endfor %}

        <h5>Replay</h5>
        <form action="." method="post">
            {{ form.as_p }}
            {% csrf_token %}
            <!-- Hidden input for parent comment.id -->
            <input type="hidden" name="parent_id" value="{{ comment.id }}">
            <input class="btn btn-primary" type="submit" value="답글 달기">
        </form>
    </div>
{% empty %}
<h4>There are no comments yet.</h4>
{% endfor %}

{% endblock %}